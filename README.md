![изображение](https://github.com/user-attachments/assets/ad6c9026-6a3f-481e-a0ff-3012810b5cbc)# Прогноз волатильности криптовалюты

## Цель проекта: 
разработка моделей предсказания волатильности Bitcoin (средняя дневная реализованная волатильность за неделю) с использованием моделей GARCH, GJR-GARCH, TARCH и машинного обучения LSTM
## Актуальность: 
необходимость предоставления инвесторам инструментов для эффективного управления инвестиционным портфелем, минимизации потенциальных убытков и максимизации доходности через принятие обоснованных решений в условиях высокой неопределенности и риска, характерных для рынка криптовалют. 
## Объект исследования: 
волатильность дневного обменного курса BTC к доллару США.
## Предмет исследования: 
методы прогнозирования волатильности дневного обменного курса BTC к доллару США.

#### Особенности криптовалютного рынка 
Высокая волатильность –  цены могут претерпевать резкие колебания, характеризующиеся внезапными скачками или обвалами, происходящими в течение нескольких часов. 
####  Факторы, способствующие волатильности криптовалют:
1.	Спрос и предложение: Круглосуточные торги  
2.	Отсутствие регулирования
3.	Новостные события:  Глобальная экономическая нестабильность, уровень инфляции и изменения на традиционных финансовых рынках 
4.	Ликвидность: уровень ликвидности криптовалюты также влияет на ее волатильность.  Наиболее ликвидные активы менее волатильные по своей природе
5.	Проблемы безопасности: нарушения безопасности и хакерские инциденты подрывают доверие инвесторов к криптовалютам

#### Экономическая роль измерения волатильности криптовалют
Измерение волатильности криптовалют играет важную роль в сфере риск-менеджмента и управления портфелями.
В контексте управления рисками измерение волатильности криптовалют позволяет инвесторам и трейдерам принимать обоснованные решения о размерах позиций, кредитном плече и уровнях стоп-лосса.
Кроме того, измерение волатильности играет важную роль в расчете показателей риска, таких как стоимость риска и ожидаемый убыток. Оценка волатильности также способствует ценообразованию производных инструментов, таких как опционы и фьючерсные контракты на криптовалюты.
Регулирующие органы могут использовать показатели волатильности на криптовалютном рынке. Отслеживая периоды повышенной нестабильности, они могут принимать меры по защите инвесторов и обеспечению стабильности рынка. Это может включать в себя введение ограничений на торговлю , повышение требований к капиталу бирж или предупреждение общественности о потенциальных рисках.

В сфере управления портфелем измерение волатильности криптовалют необходимо для оптимизации распределения активов и создания хорошо диверсифицированных портфелей. Криптовалюты с различными профилями риска и доходности предоставляют возможности для диверсификации потенциальной доходности с поправкой на риск. 
Некоторые инвесторы используют волатильность в качестве сигнала для стратегий рыночного тайминга. Например, периоды высокой волатильности могут открывать возможности для покупки недооцененных активов, а периоды низкой волатильности могут указывать на время для продажи.


## Данные

Исторический набор данных о ценах открытия / закрытия , максимальных / минимальных ценах биткойна был получен с использованием Yahoo Finance API yfinance.

Я буду загружать цены BTC-USD с помощью тикера BTC-USD с интервалом в 1 день. Рассмотрим период, охватывающий около 10 лет торговых дней (2014 - 2024)
![изображение](https://github.com/user-attachments/assets/e63f004a-4b7e-48dc-b123-559920de0933)

Расчет стандартного отклонения
В практических целях обычно предпочтительнее использовать логарифмические результаты, особенно в математическом моделировании, поскольку это помогает устранить нестационарные свойства данных временных рядов, и делает их более стабильными:

![изображение](https://github.com/user-attachments/assets/39d6be66-717f-40b1-85ed-085ce78ec0db)

И затем, чтобы масштабировать дневную волатильность с определенной частотой (еженедельно, ежемесячно, ежегодно), мы можем умножить дневную волатильность на квадратный корень из этой частоты в пересчете на день, деленный на (INTERVAL_WINDOW - 1). 

![изображение](https://github.com/user-attachments/assets/d58e99cb-d728-4e11-abb4-9a1b20ec062c)


Выбор Интервального окна

Для этого проекта я буду использовать интервал в 30 дней (что эквивалентно примерно 1 месяцу торговли криптовалютами). Цель здесь состоит в том, чтобы спрогнозировать среднюю реализованную волатильность для последущих n_future 7 дней , использую все предыдущие доступные точки данных с моделями GARCH, а также с использованием ряда прошлых / исторических точек данных (n_past) с нейронными сетями (прогнозирование с использованием скользящего окна).

![изображение](https://github.com/user-attachments/assets/e8a7922a-0cae-46fe-b940-4609a0eae5a2)

Причина, по которой я выбрал 30 дней, заключается в том, что 7 дней кажутся слишком шумными для наблюдения значимых паттернов, в то время как более длительные интервалы, кажется, значительно сглаживают волатильность и имеют тенденцию возвращаться к среднему значению.
Использование интервала в 30 дней также помогло бы избежать потери слишком большого количества точек данных в начале набора данных.

### Предварительный анализ данных
За прошлые годы криптовалюты претерпели некоторые структурные изменения, которые напрямую повлияли на волатильность, такие как:
Крипто опционы стали доступны на бирже деривативов на криптовалюту Deribit в 2016 году
Фьючерсы на биткоин были предложены в 2017 году на Чикагской товарной бирже (CME), которая представляет собой организованную биржу для торговли фьючерсами и опционами
запуск торгов биткоин-опционами на CME
Эти события позволили людям более эффективно торговать криптовалютами

Мы можем видеть эти крупные события, отраженные на графике выше - первый рекордный пик биткоина в 2017 году (около 19 800 долларов США к концу декабря). И выбросы в 2020 году соответствовали его более чем 200%-ному росту в 2020 году (цена биткойна составляла 7200 долларов США в начале 2020 года). В середине декабря 2020 года он достиг 20 000 долларов США на большинстве бирж, а затем всего 17 дней спустя достиг 30 000 долларов США, что является значительным достижением. 
![изображение](https://github.com/user-attachments/assets/1a8af50c-7ea1-4ffb-99e3-41066dc88fe3)

#### проверка стационарности доходности/Log доходности

Когда мы создаем прогнозирующую Модель для временных рядов, нам требуются стационарные временные ряды, то есть обладающие одинаковой Ковариацией Выборок одного размера. 

Augmented Dickey-Fuller test

Тест ADF (расширенный тест Дики — Фуллера) — проверка Статистической значимости, которая демонстрирует результаты проверки Нулевой гипотезы (Null Hypothesis) и Альтернативной (Alternative Hypothesis). В результате мы получим P-значение (P Value), из которого можно сделать вывод о Стационарности Временного ряда

Данные Returns и Log returns стационарны, отсутствует зависимость данных от времени и тренда.


### Разделение данных для тренировки, валидации и тестирования модели

Поскольку криптовалюты не торгуются на регулируемой бирже, рынок биткоинов открыт 24/7, 1 год охватывает целых 365 торговых дней вместо 252 дней в году, как в случае с другими акциями и сырьевыми товарами.
 - Для окончательного тестирования модели будут использоваться 30 последних доступных точек данных
- 1 полный год (365 дней) на валидацию и настройку модели во время обучения
- оставшиеся данные - для обучения

![изображение](https://github.com/user-attachments/assets/66e3d16b-8bd8-4b05-b416-1db6c6bb6d9e)

#### Показатели эффективности прогнозов модели 

При прогнозировании и оценке качества предсказания на обучающих данных (in-sample prediction) мы используем показатель RMSE (среднеквадратичная ошибка прогноза). Напротив, на данных тестирования (вневыборочного предсказания) или валидации мы используем RMSPE. 
Меньшие значения RMSPE указывают на более точные прогнозы.

![изображение](https://github.com/user-attachments/assets/e3527a32-7e4a-47af-9bc7-a9a9c0258ce7)


#### GARCH Models

GARCH Generalized Autoregressive Conditional Heteroskedasticity расшифровывается как обобщенная авторегрессионная условная гетероскедастичность, которая является расширением модели ARCH (Авторегрессионная условная гетероскедастичность).
GARCH включает является традиционным эконометрическим подходом к прогнозированию волатильности финансовых временных рядов.

- Рассмотрим Модель GARCH с асимметричными реакциями на шоки

Базовая модель GARCH предполагает, что позитивные и негативные новости оказывают одинаковое влияние на волатильность. Однако на самом деле воздействие обычно асимметрично, и негативные воздействия, как правило, влияют на волатильность больше , чем положительные.

 GJR-GARCH (сокращение от Glosten-Jagannathan-Runkle GARCH).
![изображение](https://github.com/user-attachments/assets/c1fc7cd9-7e80-4b4e-b83e-225a0008cd9f)

В семействе GARCH есть еще TARCH Threshold Autoregressive Conditional Heteroskedasticity , что является сокращением от Пороговой авторегрессионной условной гетероскедастичности (и также известный как ZARCH). 
![изображение](https://github.com/user-attachments/assets/1976a27a-4089-44a3-96ce-e694dc0ee06c)



### Нейронные сети

Параметры модели

Epoch относится к одному полному прохождению всего набора обучающих данных через алгоритм обучения. Другими словами, когда все образцы данных подвергаются воздействию нейронной сети для изучения шаблонов, одна эпоха считается завершенной.

Количество эпох — это гиперпараметр , который определяет, сколько раз алгоритм обучения будет работать со всем набором обучающих данных. Слишком мало эпох может привести к недостаточной подгонке модели, тогда как слишком большое количество эпох может привести к переобучению.

Epoch , Iterations и Batches

Batches: набор из N выборок из набора данных. Размер пакета — это гиперпараметр, определяющий количество выборок, которые необходимо обработать перед обновлением внутренних параметров модели. Итерация: одно обновление параметров модели. Каждая итерация — это количество пакетов, необходимых для завершения одной эпохи. Epoch: один полный цикл обработки данных обучения

В течение каждой эпохи веса нейронной сети обновляются в попытке минимизировать функцию потерь , которая измеряет разницу между прогнозируемыми и истинными выходными данными. По мере увеличения количества эпох веса настраиваются, и в идеале точность модели повышается.

##### Long Short-Term Memory (LSTM)
 На каждом временном шаге t рекуррентный нейрон получает входные данные xt , а также его собственный результат из предыдущего временного шага yt−1. Поскольку выходной сигнал рекуррентного нейрона является функцией всех входных сигналов с предыдущих временных шагов, он имеет форму памяти и способный сохранять некоторую информацию с течением времени.

Однако из-за некоторых преобразований, через которые проходят данные при перемещении вниз по RNN, некоторая информация теряется на каждом временном шаге, и для длинной последовательности состояние RNN не содержит практически никакой информации из первых входных данных.

Ключевой частью LSTM является то, что сеть может узнавать, что важно и должно храниться в долгосрочном состоянии, а что можно игнорировать. 

Первая модель LSTM была бы очень простой, имея всего 1 скрытый слой LSTM из 20 единиц. Я использую стандартный adam оптимизатор

![изображение](https://github.com/user-attachments/assets/9c6f19e8-cee7-40ae-bd87-876841a3d216)


###### двухслойный двунаправленный LSTM 


Дальнейшие исследования показывают, что существует Bidirectional LSTM (Двунаправленное LSTM), которое потенциально могло бы быть лучше в этом случае, предоставляя дополнительный контекст моделям. Поскольку все временные интервалы входной последовательности уже доступны, двунаправленный LSTM может обучать 2 вместо 1 LSTM для одной и той же входной последовательности:

• первый на входах как есть

• второй на обратной копии входных данных

LSTM позволяет сохранять определенные исторические данные, поэтому я их расширю n_past до 1 месяца, а также увеличу количество скрытых слоев, чтобы увидеть, сможет ли модель лучше передавать определенные тенденции.

Слой Forward LSTM: Этот слой обрабатывает входную последовательность от начала до конца, улавливая зависимости от прошлого к будущему.

Обратный LSTM-слой: Этот слой обрабатывает входную последовательность в обратном порядке, улавливая зависимости от будущего к прошлому.

Основная идея использования двунаправленных LSTM заключается в том, чтобы позволить модели обращаться к прошлой и будущей информации при составлении прогнозов, тем самым улучшая ее способность улавливать временные зависимости в данных.

![изображение](https://github.com/user-attachments/assets/35f2b833-3796-491b-94aa-c4297ccd898d)

![изображение](https://github.com/user-attachments/assets/680e1c05-1767-4427-ac68-dfb7ca3b99ed)

### Выводы
 GARCH (1,1), рассчитанная на основе данных доходности, по прогнозу уступает случайному блужданию. По сравнению с GARCH (1,1) и моделью TARCH(1,1), построенной на основе метода Bootstrap,  прогнозирование аналитическим методом GJR-GARCH (1,1,1) на следующие 7 дней с учетом скошенного распределения T-Стьюдента значительно продвинулись вперед и лучше отразило целевые значения.
Однослойная модель LSTM значительно лучше отражает целевые значения по сравнению с моделью LR NN и базовой моделью GARCH(1,1), но все еще не превосходит GJR-GARCH(1,1,1) по метрике RMSPE. 
Модель двухслойной двунаправленной LSTM с окном анализа в 30 дней, лучше предыдущих моделей на основе нейронных сетей  отражает паттерны волатильности.

 Трейдерам не нужно делать идеально точный прогноз, чтобы иметь положительное ожидание при участии в рынке. Модели LSTM могут дать инвесторам преимущество в виде более высокой точности прогнозирования

 По причине изменчивости финансовых временных рядов, ни одна модель не сможет постоянно прогнозировать с высокой точностью, с течением времени ей свойственно терять свою предсказательную силу. Поэтому такие модели нуждаются в постоянной доработке и настройке на основе свежей информации, чтобы они оставались актуальными и учились развиваться вместе с рынками.
 
